<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>ìŒì„±í†µì—­ ì—°ìŠµ í”Œë ˆì´ì–´</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root {
      color-scheme: light;
      --bg: #0f172a;
      --card: #1f2937;
      --accent: #3b82f6;
      --accent-soft: rgba(59,130,246,0.2);
      --text: #e5e7eb;
      --muted: #9ca3af;
      --danger: #f97373;
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      padding: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Noto Sans KR", sans-serif;
      background: radial-gradient(circle at top, #1e293b 0, #020617 55%, #000 100%);
      color: var(--text);
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: stretch;
    }

    .app {
      width: 100%;
      max-width: 960px;
      margin: 16px;
      padding: 20px;
      border-radius: 18px;
      background: linear-gradient(145deg, rgba(15,23,42,0.95), rgba(15,23,42,0.9));
      box-shadow:
        0 24px 60px rgba(0,0,0,0.7),
        0 0 0 1px rgba(148,163,184,0.25);
      display: flex;
      flex-direction: column;
      gap: 14px;
    }

    header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 12px;
      flex-wrap: wrap;
    }

    .title-group {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    h1 {
      font-size: 1.4rem;
      margin: 0;
    }

    .subtitle {
      font-size: 0.85rem;
      color: var(--muted);
    }

    .badge {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 4px 10px;
      border-radius: 999px;
      border: 1px solid rgba(148,163,184,0.5);
      font-size: 0.75rem;
      color: var(--muted);
    }

    .badge-dot {
      width: 7px;
      height: 7px;
      border-radius: 999px;
      background: #22c55e;
      box-shadow: 0 0 0 4px rgba(34,197,94,0.3);
    }

    .main {
      display: grid;
      grid-template-columns: minmax(0, 2.2fr) minmax(0, 1.6fr);
      gap: 16px;
    }

    @media (max-width: 840px) {
      .main {
        grid-template-columns: 1fr;
      }
    }

    .video-card,
    .info-card {
      background: radial-gradient(circle at top left, rgba(148,163,184,0.08), rgba(15,23,42,0.96));
      border-radius: 16px;
      padding: 12px 12px 14px;
      border: 1px solid rgba(148,163,184,0.35);
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .video-wrapper {
      position: relative;
      border-radius: 14px;
      overflow: hidden;
      background: #020617;
      border: 1px solid rgba(148,163,184,0.3);
      box-shadow: 0 14px 30px rgba(0,0,0,0.7);
    }

    video {
      width: 100%;
      display: block;
      background: #000;
    }

    .video-meta {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 0.8rem;
      color: var(--muted);
      gap: 8px;
      flex-wrap: wrap;
    }

    .pill {
      padding: 3px 9px;
      border-radius: 999px;
      background: rgba(15,23,42,0.9);
      border: 1px solid rgba(148,163,184,0.3);
    }

    .controls-primary,
    .controls-secondary {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
    }

    .controls-primary {
      margin-top: 4px;
      align-items: center;
    }

    .controls-secondary {
      justify-content: space-between;
      align-items: center;
      gap: 6px;
    }

    .btn {
      padding: 6px 12px;
      border-radius: 999px;
      border: 1px solid rgba(148,163,184,0.5);
      background: rgba(15,23,42,0.95);
      color: var(--text);
      font-size: 0.85rem;
      display: inline-flex;
      align-items: center;
      gap: 4px;
      cursor: pointer;
      transition: background 0.15s ease, transform 0.05s ease, box-shadow 0.15s ease, border-color 0.15s ease;
      white-space: nowrap;
    }

    .btn:hover {
      background: rgba(30,64,175,0.75);
      border-color: rgba(96,165,250,0.9);
      box-shadow: 0 0 0 1px rgba(96,165,250,0.6);
    }

    .btn:active {
      transform: translateY(1px);
      box-shadow: none;
    }

    .btn-primary {
      background: var(--accent);
      border-color: rgba(129,140,248,0.9);
      box-shadow: 0 12px 25px rgba(59,130,246,0.45);
      font-weight: 600;
    }

    .btn-primary:hover {
      background: #2563eb;
    }

    .btn-toggle {
      background: rgba(15,23,42,0.95);
    }

    .btn-toggle.active {
      background: var(--accent-soft);
      border-color: var(--accent);
      color: #bfdbfe;
    }

    .key-hint {
      font-size: 0.7rem;
      padding: 1px 6px;
      border-radius: 999px;
      border: 1px solid rgba(148,163,184,0.5);
      background: rgba(15,23,42,0.95);
      color: var(--muted);
    }

    .progress-row {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 0.75rem;
      color: var(--muted);
      margin-top: 6px;
    }

    .progress-row input[type="range"] {
      flex: 1;
      cursor: pointer;
      accent-color: var(--accent);
    }

    .answer-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 8px;
    }

    .answer-box {
      margin-top: 8px;
      padding: 10px 11px;
      border-radius: 12px;
      background: rgba(15,23,42,0.95);
      border: 1px dashed rgba(148,163,184,0.6);
      min-height: 48px;
      font-size: 0.9rem;
      line-height: 1.5;
      white-space: pre-line;
    }

    .answer-box.hidden-text {
      color: var(--muted);
      font-style: italic;
    }

    .answer-label {
      font-size: 0.8rem;
      color: var(--muted);
    }

    .answer-text strong {
      color: #e5e7eb;
    }

    .shortcut-list {
      font-size: 0.78rem;
      color: var(--muted);
      display: flex;
      flex-direction: column;
      gap: 4px;
      margin-top: 6px;
    }

    .shortcut-item {
      display: flex;
      gap: 4px;
      align-items: baseline;
    }

    .shortcut-keys {
      min-width: 78px;
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-size: 0.72rem;
      color: #cbd5f5;
    }

    .shortcut-desc {
      flex: 1;
    }

    footer {
      margin-top: 6px;
      font-size: 0.75rem;
      color: var(--muted);
      display: flex;
      justify-content: space-between;
      gap: 8px;
      flex-wrap: wrap;
    }

    .small-pill {
      padding: 2px 8px;
      border-radius: 999px;
      border: 1px solid rgba(148,163,184,0.45);
      background: rgba(15,23,42,0.96);
    }

    select, input[type="range"] {
      background: rgba(15,23,42,0.96);
      border-radius: 999px;
      border: 1px solid rgba(148,163,184,0.6);
      color: var(--text);
      padding: 4px 8px;
      font-size: 0.8rem;
    }

    select:focus, input[type="range"]:focus-visible {
      outline: 2px solid var(--accent);
      outline-offset: 1px;
    }

    .speed-label {
      font-size: 0.78rem;
      color: var(--muted);
      margin-right: 4px;
    }

    .counter-pill {
      padding: 3px 8px;
      border-radius: 999px;
      background: rgba(15,23,42,0.9);
      border: 1px solid rgba(148,163,184,0.5);
      font-size: 0.78rem;
      color: var(--muted);
    }

    .danger {
      color: var(--danger);
    }
  </style>
</head>
<body>
  <div class="app">
    <header>
      <div class="title-group">
        <h1>ìŒì„±í†µì—­ ì—°ìŠµ í”Œë ˆì´ì–´ (í…ŒìŠ¤íŠ¸)</h1>
        <div class="subtitle">
          ìˆ˜ì–´ ì˜ìƒì„ ë³´ê³  <strong>ë¨¸ë¦¿ì†ìœ¼ë¡œ í•´ì„ â†’ ì…ìœ¼ë¡œ ë§í•˜ê¸°</strong> ì—°ìŠµ í›„<br />
          ã€Œì •ë‹µ ë³´ê¸°ã€ë¡œ í‘œì œì–´ì™€ ìš©ë¡€ ë¬¸ì¥ì„ í™•ì¸í•˜ì„¸ìš”.
        </div>
      </div>
      <div class="badge">
        <span class="badge-dot"></span>
        GitHub ì •ì  í˜ì´ì§€ìš© Â· ë¡œì»¬ ì˜ìƒ ì¬ìƒ
      </div>
    </header>

    <div class="main">
      <!-- ì™¼ìª½: ì˜ìƒ / ê¸°ë³¸ ì¡°ì‘ -->
      <section class="video-card">
        <div class="video-wrapper" id="video-container">
          <video id="video" controls playsinline>
            <!-- srcëŠ” JSì—ì„œ ì„¤ì • -->
            ë¸Œë¼ìš°ì €ê°€ video íƒœê·¸ë¥¼ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
          </video>
        </div>

        <div class="video-meta">
          <span class="pill" id="meta-index">0 / 0</span>
          <span class="pill" id="meta-file">íŒŒì¼: -</span>
        </div>

        <div class="controls-primary">
          <button class="btn" id="btn-prev">
            â—€ ì´ì „ (<span class="key-hint">â†</span>)
          </button>
          <button class="btn btn-primary" id="btn-play-pause">
            â–¶ ì¬ìƒ / ì¼ì‹œì •ì§€ (<span class="key-hint">Space</span>)
          </button>
          <button class="btn" id="btn-next">
            ë‹¤ìŒ â–¶ (<span class="key-hint">â†’</span>)
          </button>
          <button class="btn btn-toggle" id="btn-random">
            ğŸ”€ ëœë¤ ìˆœì„œ (<span class="key-hint">R</span>)
          </button>
          <button class="btn" id="btn-fullscreen">
            â›¶ ì „ì²´í™”ë©´ (<span class="key-hint">F</span>)
          </button>
        </div>

        <div class="controls-secondary">
          <div style="display:flex;align-items:center;gap:6px;flex-wrap:wrap;">
            <span class="speed-label">ì¬ìƒì†ë„</span>
            <select id="speed-select">
              <option value="0.5">0.5x</option>
              <option value="0.75">0.75x</option>
              <option value="1" selected>1.0x</option>
              <option value="1.25">1.25x</option>
              <option value="1.5">1.5x</option>
              <option value="2">2.0x</option>
            </select>
          </div>
          <div class="progress-row">
            <span id="time-current">00:00</span>
            <input type="range" id="seek-bar" min="0" max="100" step="0.1" value="0" />
            <span id="time-duration">00:00</span>
          </div>
        </div>
      </section>

      <!-- ì˜¤ë¥¸ìª½: ì •ë‹µ/ë‹¨ì¶•í‚¤ ì•ˆë‚´ -->
      <section class="info-card">
        <div class="answer-header">
          <div>
            <div class="answer-label">í˜„ì¬ ë¬¸ì œ</div>
            <div id="current-label" style="font-size:0.9rem;margin-top:2px;color:#e5e7eb;">
              -
            </div>
          </div>
          <div style="display:flex;flex-direction:column;align-items:flex-end;gap:4px;">
            <button class="btn btn-primary" id="btn-toggle-answer">
              ì •ë‹µ ë³´ê¸° (<span class="key-hint">A</span>)
            </button>
            <span class="answer-label" id="answer-status">í˜„ì¬: ì •ë‹µ ìˆ¨ê¹€</span>
          </div>
        </div>

        <div class="answer-box hidden-text" id="answer-box">
          ì •ë‹µì„ ë³´ë ¤ë©´ ìœ„ì˜ ã€Œì •ë‹µ ë³´ê¸°ã€ ë²„íŠ¼ ë˜ëŠ” A í‚¤ë¥¼ ëˆ„ë¥´ì„¸ìš”.
        </div>

        <div class="shortcut-list">
          <div class="shortcut-item">
            <span class="shortcut-keys">â† / â†’</span>
            <span class="shortcut-desc">ì´ì „ / ë‹¤ìŒ ì˜ìƒìœ¼ë¡œ ì´ë™</span>
          </div>
          <div class="shortcut-item">
            <span class="shortcut-keys">Space</span>
            <span class="shortcut-desc">ì¬ìƒ / ì¼ì‹œì •ì§€</span>
          </div>
          <div class="shortcut-item">
            <span class="shortcut-keys">R</span>
            <span class="shortcut-desc">ëœë¤ ìˆœì„œ í† ê¸€ (ì¼œë©´ ì „ì²´ ëª©ë¡ ì„ê¸°)</span>
          </div>
          <div class="shortcut-item">
            <span class="shortcut-keys">F</span>
            <span class="shortcut-desc">ì „ì²´í™”ë©´ í† ê¸€ (ì˜ìƒ ì˜ì—­ ê¸°ì¤€)</span>
          </div>
          <div class="shortcut-item">
            <span class="shortcut-keys">J / L</span>
            <span class="shortcut-desc">5ì´ˆ ë’¤ë¡œ(J) / 5ì´ˆ ì•ìœ¼ë¡œ(L) ì´ë™</span>
          </div>
          <div class="shortcut-item">
            <span class="shortcut-keys">â†“ / â†‘</span>
            <span class="shortcut-desc">ì¬ìƒì†ë„ 0.1x ë‹¨ìœ„ë¡œ ëŠë¦¬ê²Œ / ë¹ ë¥´ê²Œ</span>
          </div>
          <div class="shortcut-item">
            <span class="shortcut-keys">A</span>
            <span class="shortcut-desc">ì •ë‹µ ë³´ê¸° / ìˆ¨ê¸°ê¸°</span>
          </div>
        </div>
      </section>
    </div>

    <footer>
      <div class="small-pill">
        ğŸ”§ GitHubì— ì˜¬ë¦´ ë•Œ: <code>index.html</code> + <code>videos/íŒŒì¼ëª….webm</code> êµ¬ì¡° ìœ ì§€
      </div>
      <div class="counter-pill" id="debug-info">
        ì¤€ë¹„ ì¤‘...
      </div>
    </footer>
  </div>

  <script>
    // ===== 1. ë°ì´í„° ì •ì˜ =====
    // ë™ì˜ìƒ íŒŒì¼ì€ ./videos í´ë”ì— ë„£ëŠ”ë‹¤ê³  ê°€ì •
    const VIDEO_BASE_PATH = "./videos/";

    /** @type {{id:string, file:string, headword:string, sentence:string}[]} */
    const ITEMS = [
      {
        id: "1-1",
        file: "1-1.webm",
        headword: "ë³´ë‹¤",
        sentence: "1) ë‚´ê°€ ë‹´ê·¼ ê¹€ì¹˜ê°€ ì‚¬ ë¨¹ëŠ” ê¹€ì¹˜ë³´ë‹¤ ë§›ìˆë‹¤."
      },
      {
        id: "1-2",
        file: "1-2.webm",
        headword: "ë³´ë‹¤",
        sentence: "2) ë‚˜ëŠ” ìƒëŒ€ë°©ë³´ë‹¤ ì–¸ë³€ì´ ë” ì¢‹ë‹¤."
      },
      {
        id: "1-3",
        file: "1-3.webm",
        headword: "ë³´ë‹¤",
        sentence: "3) ì†Œí˜• ì„ í’ê¸°ë³´ë‹¤ ëŒ€í˜• ì„ í’ê¸°ê°€ ë°”ëŒì´ ë” ì„¸ë‹¤."
      },
      {
        id: "1-4",
        file: "1-4.webm",
        headword: "ë³´ë‹¤",
        sentence: "4) ì²­ë ¥ê²€ì‚¬ ê²°ê³¼ ë‚˜ëŠ” ì˜¤ë¥¸ìª½ ê·€ì˜ ì²­ë ¥ì´ ë” ì¢‹ë‹¤."
      },
      {
        id: "1-5",
        file: "1-5.webm",
        headword: "ë³´ë‹¤",
        sentence: "5) ì–¸ë‹ˆê°€ ë‚˜ë³´ë‹¤ ìš”ë¦¬ ì†œì”¨ê°€ ë” ë›°ì–´ë‚˜ë‹¤."
      },
      {
        id: "2-1",
        file: "2-1.webm",
        headword: "ê°€ì ¸ì˜¤ë‹¤",
        sentence: "1) ë”°ëœ»í•œ ë¬¼ì„ ê°€ì ¸ë‹¤ì£¼ì„¸ìš”."
      },
      {
        id: "2-2",
        file: "2-2.webm",
        headword: "ê°€ì ¸ì˜¤ë‹¤",
        sentence: "2) íšŒì˜ë¡ì„ ì €ì—ê²Œ ê°€ì§€ê³  ì˜¤ì„¸ìš”."
      }
    ];

    // ===== 2. ìƒíƒœ ê´€ë¦¬ =====
    let playOrder = ITEMS.map((_, i) => i); // í˜„ì¬ ì¬ìƒ ìˆœì„œ(ì¸ë±ìŠ¤ ë°°ì—´)
    let currentOrderIndex = 0;              // playOrderì—ì„œì˜ ìœ„ì¹˜
    let isRandom = false;
    let answerVisible = false;

    // ===== 3. DOM ì°¸ì¡° =====
    const videoEl = document.getElementById("video");
    const metaIndexEl = document.getElementById("meta-index");
    const metaFileEl = document.getElementById("meta-file");
    const currentLabelEl = document.getElementById("current-label");
    const answerBoxEl = document.getElementById("answer-box");
    const answerStatusEl = document.getElementById("answer-status");
    const debugInfoEl = document.getElementById("debug-info");

    const btnPrev = document.getElementById("btn-prev");
    const btnNext = document.getElementById("btn-next");
    const btnPlayPause = document.getElementById("btn-play-pause");
    const btnRandom = document.getElementById("btn-random");
    const btnFullscreen = document.getElementById("btn-fullscreen");
    const btnToggleAnswer = document.getElementById("btn-toggle-answer");

    const speedSelect = document.getElementById("speed-select");
    const seekBar = document.getElementById("seek-bar");
    const timeCurrent = document.getElementById("time-current");
    const timeDuration = document.getElementById("time-duration");
    const videoContainer = document.getElementById("video-container");

    // ===== 4. ìœ í‹¸ë¦¬í‹° =====
    function pad(num) {
      return num.toString().padStart(2, "0");
    }

    function formatTime(sec) {
      if (!isFinite(sec)) return "00:00";
      const s = Math.floor(sec);
      const m = Math.floor(s / 60);
      const r = s % 60;
      return `${pad(m)}:${pad(r)}`;
    }

    function shuffleArray(arr) {
      const copy = arr.slice();
      for (let i = copy.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [copy[i], copy[j]] = [copy[j], copy[i]];
      }
      return copy;
    }

    function getCurrentItem() {
      const idx = playOrder[currentOrderIndex] ?? 0;
      return ITEMS[idx];
    }

    function updateDebugInfo() {
      const item = getCurrentItem();
      const mode = isRandom ? "ëœë¤" : "ìˆœì„œ";
      debugInfoEl.textContent = `ëª¨ë“œ: ${mode} Â· í˜„ì¬: ${currentOrderIndex + 1}/${playOrder.length} Â· ID: ${item.id}`;
    }

    // ===== 5. ë¡œë”© / í™”ë©´ ê°±ì‹  =====
    function loadCurrentVideo(autoPlay = false) {
      const total = playOrder.length;
      if (total === 0) return;

      // ë²”ìœ„ ë³´ì •
      if (currentOrderIndex < 0) currentOrderIndex = total - 1;
      if (currentOrderIndex >= total) currentOrderIndex = 0;

      const itemIndex = playOrder[currentOrderIndex];
      const item = ITEMS[itemIndex];

      const src = VIDEO_BASE_PATH + item.file;
      if (videoEl.src !== src) {
        videoEl.src = src;
      }

      // ë©”íƒ€ ì •ë³´
      metaIndexEl.textContent = `${currentOrderIndex + 1} / ${total}`;
      metaFileEl.textContent = `íŒŒì¼: ${item.file}`;
      currentLabelEl.textContent = `${item.headword} Â· ${item.id}`;

      // ì •ë‹µì€ í•­ìƒ ìˆ¨ê¹€ ìƒíƒœë¡œ ì‹œì‘
      setAnswerVisible(false);

      // ì¬ìƒ ì‹œê°„ í‘œì‹œ ì´ˆê¸°í™”
      seekBar.value = 0;
      timeCurrent.textContent = "00:00";
      timeDuration.textContent = "00:00";

      // ìë™ ì¬ìƒ
      if (autoPlay) {
        videoEl.currentTime = 0;
        videoEl.play().catch(() => {
          // ìë™ ì¬ìƒ ë§‰íŒ ê²½ìš° ë¬´ì‹œ
        });
      }

      updateDebugInfo();
    }

    function setAnswerVisible(visible) {
      answerVisible = visible;
      const item = getCurrentItem();
      if (visible) {
        answerBoxEl.classList.remove("hidden-text");
        answerBoxEl.innerHTML =
          `<div class="answer-text"><strong>[í‘œì œì–´]</strong> ${item.headword}<br/><strong>[ìš©ë¡€]</strong> ${item.sentence}</div>`;
        answerStatusEl.textContent = "í˜„ì¬: ì •ë‹µ í‘œì‹œ ì¤‘";
      } else {
        answerBoxEl.classList.add("hidden-text");
        answerBoxEl.textContent =
          "ì •ë‹µì„ ë³´ë ¤ë©´ ìœ„ì˜ ã€Œì •ë‹µ ë³´ê¸°ã€ ë²„íŠ¼ ë˜ëŠ” A í‚¤ë¥¼ ëˆ„ë¥´ì„¸ìš”.";
        answerStatusEl.textContent = "í˜„ì¬: ì •ë‹µ ìˆ¨ê¹€";
      }
    }

    function toggleAnswer() {
      setAnswerVisible(!answerVisible);
    }

    // ===== 6. ì¡°ì‘ í•¨ìˆ˜ =====
    function goNext(autoPlay = true) {
      currentOrderIndex++;
      if (currentOrderIndex >= playOrder.length) currentOrderIndex = 0;
      loadCurrentVideo(autoPlay);
    }

    function goPrev(autoPlay = true) {
      currentOrderIndex--;
      if (currentOrderIndex < 0) currentOrderIndex = playOrder.length - 1;
      loadCurrentVideo(autoPlay);
    }

    function togglePlayPause() {
      if (videoEl.paused) {
        videoEl.play().catch(() => {});
      } else {
        videoEl.pause();
      }
    }

    function setRandomMode(on) {
      isRandom = on;
      if (on) {
        // í˜„ì¬ ë³´ê³ ìˆëŠ” ì•„ì´í…œì€ ìœ ì§€í•œ ìƒíƒœì—ì„œ ìˆœì„œë§Œ ì„ê³ , ê·¸ ì•„ì´í…œì„ ë§¨ ì•ìœ¼ë¡œ ë°°ì¹˜
        const currentItemIndex = playOrder[currentOrderIndex] ?? 0;
        const base = ITEMS.map((_, i) => i);
        const shuffled = shuffleArray(base);
        const currentPos = shuffled.indexOf(currentItemIndex);
        if (currentPos > 0) {
          [shuffled[0], shuffled[currentPos]] = [shuffled[currentPos], shuffled[0]];
        }
        playOrder = shuffled;
        currentOrderIndex = 0;
        btnRandom.classList.add("active");
      } else {
        // ì›ë˜ ìˆœì„œë¡œ
        const currentItem = getCurrentItem();
        playOrder = ITEMS.map((_, i) => i);
        currentOrderIndex = playOrder.indexOf(ITEMS.indexOf(currentItem));
        btnRandom.classList.remove("active");
      }
      loadCurrentVideo(false);
    }

    function adjustPlaybackRate(delta) {
      let rate = videoEl.playbackRate + delta;
      rate = Math.min(2.0, Math.max(0.3, rate));
      rate = Math.round(rate * 10) / 10; // 0.1 ë‹¨ìœ„
      videoEl.playbackRate = rate;
      // ì…€ë ‰íŠ¸ ë°•ìŠ¤ ê°±ì‹  (ê·¼ì‚¬ê°’ ì°¾ê¸°)
      let found = false;
      for (const opt of speedSelect.options) {
        if (Math.abs(parseFloat(opt.value) - rate) < 0.05) {
          speedSelect.value = opt.value;
          found = true;
          break;
        }
      }
      if (!found) {
        // ì•ˆ ë§ìœ¼ë©´ ê·¸ëƒ¥ value ì—…ë°ì´íŠ¸ìš© ì„ì‹œ ì˜µì…˜ìœ¼ë¡œ ëŒ€ì²´ ê°€ëŠ¥í•˜ì§€ë§Œ
        // ì—¬ê¸°ì„œëŠ” ë¬´ì‹œ (í‘œì‹œë§Œ ì¡°ê¸ˆ ì–´ê¸‹ë‚  ìˆ˜ ìˆìŒ)
      }
    }

    function seekBy(seconds) {
      const t = videoEl.currentTime + seconds;
      videoEl.currentTime = Math.min(videoEl.duration || t, Math.max(0, t));
    }

    function toggleFullscreen() {
      const isFull =
        document.fullscreenElement === videoContainer ||
        document.fullscreenElement === document.documentElement;
      if (!isFull) {
        if (videoContainer.requestFullscreen) {
          videoContainer.requestFullscreen();
        } else if (document.documentElement.requestFullscreen) {
          document.documentElement.requestFullscreen();
        }
      } else {
        if (document.exitFullscreen) {
          document.exitFullscreen();
        }
      }
    }

    // ===== 7. ì´ë²¤íŠ¸ ë°”ì¸ë”© =====
    // ë²„íŠ¼
    btnNext.addEventListener("click", () => goNext(true));
    btnPrev.addEventListener("click", () => goPrev(true));
    btnPlayPause.addEventListener("click", togglePlayPause);
    btnRandom.addEventListener("click", () => setRandomMode(!isRandom));
    btnFullscreen.addEventListener("click", toggleFullscreen);
    btnToggleAnswer.addEventListener("click", toggleAnswer);

    // ì†ë„ ì…€ë ‰íŠ¸
    speedSelect.addEventListener("change", () => {
      const rate = parseFloat(speedSelect.value || "1");
      videoEl.playbackRate = rate;
    });

    // ì‹œí¬ë°”
    let isSeeking = false;
    seekBar.addEventListener("input", () => {
      isSeeking = true;
      const percent = parseFloat(seekBar.value);
      if (isFinite(videoEl.duration) && videoEl.duration > 0) {
        const t = (percent / 100) * videoEl.duration;
        videoEl.currentTime = t;
        timeCurrent.textContent = formatTime(t);
      }
    });
    seekBar.addEventListener("change", () => {
      isSeeking = false;
    });

    // ë¹„ë””ì˜¤ ì‹œê°„ ì—…ë°ì´íŠ¸
    videoEl.addEventListener("loadedmetadata", () => {
      timeDuration.textContent = formatTime(videoEl.duration);
    });
    videoEl.addEventListener("timeupdate", () => {
      if (!isSeeking && isFinite(videoEl.duration) && videoEl.duration > 0) {
        const percent = (videoEl.currentTime / videoEl.duration) * 100;
        seekBar.value = percent;
        timeCurrent.textContent = formatTime(videoEl.currentTime);
      }
    });

    // ìë™ ë‹¤ìŒ ì˜ìƒ
    videoEl.addEventListener("ended", () => {
      goNext(true);
    });

    // í‚¤ë³´ë“œ ë‹¨ì¶•í‚¤
    window.addEventListener("keydown", (e) => {
      const tag = (e.target.tagName || "").toLowerCase();
      // ì…ë ¥ì°½ í¬ì»¤ìŠ¤ ì‹œì—ëŠ” ë‹¨ì¶•í‚¤ ë§‰ê¸°
      if (tag === "input" || tag === "textarea" || e.target.isContentEditable) {
        return;
      }

      switch (e.key) {
        case "ArrowRight":
          e.preventDefault();
          goNext(true);
          break;
        case "ArrowLeft":
          e.preventDefault();
          goPrev(true);
          break;
        case " ":
          e.preventDefault();
          togglePlayPause();
          break;
        case "r":
        case "R":
          e.preventDefault();
          setRandomMode(!isRandom);
          break;
        case "f":
        case "F":
          e.preventDefault();
          toggleFullscreen();
          break;
        case "j":
        case "J":
          e.preventDefault();
          seekBy(-5);
          break;
        case "l":
        case "L":
          e.preventDefault();
          seekBy(5);
          break;
        case "ArrowUp":
          e.preventDefault();
          adjustPlaybackRate(0.1);
          break;
        case "ArrowDown":
          e.preventDefault();
          adjustPlaybackRate(-0.1);
          break;
        case "a":
        case "A":
          e.preventDefault();
          toggleAnswer();
          break;
      }
    });

    // ===== 8. ì´ˆê¸°í™” =====
    function init() {
      if (!ITEMS.length) {
        debugInfoEl.textContent = "ITEMS ë°°ì—´ì´ ë¹„ì–´ ìˆìŠµë‹ˆë‹¤.";
        return;
      }

      playOrder = ITEMS.map((_, i) => i);
      currentOrderIndex = 0;
      isRandom = false;
      btnRandom.classList.remove("active");
      videoEl.playbackRate = 1.0;
      speedSelect.value = "1";
      setAnswerVisible(false);
      loadCurrentVideo(false);
    }

    init();
  </script>
</body>
</html>
